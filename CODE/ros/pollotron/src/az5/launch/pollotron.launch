<launch>
    <arg name="port_uno" value="/dev/ttyACM0"/>
    <arg name="port_mega" value="/dev/ttyACM1"/>

    <param name="robot_description" command="xacro --inorder /home/complubot/Documents/POLLOTRON/CODE/ros/pollotron/src/az5_model/urdf/robot.urdf"/>
    <node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_state_publisher"/>
<!-->
    <node pkg="rosserial_python" name="pollotron_motors" type="serial_node.py" args="$(arg port_mega)" output="screen" respawn="true" />
    <node pkg="az5" type="motor_replayer" name="motor_replayer"/>
<!-->
    <include file="/home/complubot/Documents/POLLOTRON/CODE/ros/rplidar/src/rplidar_ros/launch/rplidar.launch" />
    <node pkg="az5" name="laser_filter" type="laser_filter" output="screen" respawn="true" />

    <include file="$(find realsense2_camera)/launch/rs_camera.launch" >
        <arg name="filters" value="pointcloud"/>
    </include>
    
    <node pkg="rosserial_python" name="us_reader" type="serial_node.py" args="$(arg port_uno)" output="screen" respawn="true" />
    <node pkg="az5" name="us_filter" type="us_filter" output="screen" respawn="true" />

    <node name="map_server" pkg="map_server" type="map_server" args="$(find az5)/maps/slam_map1.yaml"/>

    <node pkg="rf2o_laser_odometry" type="rf2o_laser_odometry_node" name="rf2o_laser_odometry" output="screen">
        <param name="laser_scan_topic" value="/laser_filtered"/>
        <param name="odom_topic" value="/odom" />
        <param name="publish_tf" value="true" />
        <param name="base_frame_id" value="/base_link"/>
        <param name="odom_frame_id" value="/odom" />
        <param name="init_pose_from_topic" value="" />
        <param name="freq" value="5.0"/>
        <param name="verbose" value="false" />                                  
    </node>

    <node pkg="amcl" type="amcl" name="amcl">
        <param name="odom_model_type" value="omni"/>
        <param name="odom_frame_id" value="odom"/>
        <param name="global_frame_id" value="map"/>
        <param name="base_frame_id" value="base_link"/>
        <param name="gui_publish_rate" value="5"/>
        <param name="min_particles" value="600"/>
        <param name="max_particles" value="1200"/>
        <param name="laser_max_beams" value="360"/>
        <param name="laser_likelihood_max_dist" value="3.0"/>
        <param name="update_min_d" value="0.1"/>
        <param name="update_min_a" value="0.1"/>
        <param name="odom_frame_id" value="odom"/>
        <param name="resample_interval" value="1"/>
        <param name="transform_tolerance" value="0.1"/>
        <param name="recovery_alpha_slow" value="0.001"/>
        <param name="recovery_alpha_fast" value="0.1"/>
        <param name="use_map_topic" value="true"/>
        <param name="initial_pose_x" value="0"/>
        <param name="initial_pose_y" value="0"/>
        <param name="initial_pose_a" value="0"/>
        <param name="initial_cov_xx" value="1"/>
        <param name="initial_cov_yy" value="1"/>
        <param name="initial_cov_aa" value="1"/>
    </node>

</launch>